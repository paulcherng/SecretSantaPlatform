<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ¸¬è©¦å»ºç«‹æ´»å‹•</title>
    <style>
        :root { 
            --primary-color: #4f46e5; 
            --primary-hover: #4338ca;
            --success-color: #10b981; 
            --border-color: #e5e7eb; 
            --text-color: #111827; 
            --text-muted: #6b7280;
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        * { box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px; 
            max-width: 900px; 
            margin: 0 auto;
            min-height: 100vh;
        }
        
        h1 { 
            color: white; 
            text-align: center; 
            margin-bottom: 2rem;
            font-size: 2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .container {
            background: white;
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
        }
        
        .form-group { 
            margin-bottom: 1.5rem; 
        }
        
        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }
        
        input, textarea { 
            width: 100%; 
            padding: 12px 16px; 
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        textarea {
            font-family: 'Courier New', monospace;
            resize: vertical;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 2rem;
        }
        
        button { 
            flex: 1;
            padding: 12px 24px; 
            background: var(--primary-color); 
            color: white; 
            border: none; 
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        button:hover { 
            background: var(--primary-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .result { 
            margin-top: 2rem; 
            padding: 1.5rem; 
            background: #f9fafb; 
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }
        
        .result h3 {
            margin-top: 0;
            color: var(--text-color);
        }
        
        .result pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .result a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }
        
        .result a:hover {
            text-decoration: underline;
        }
        
        .result p {
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ„ æ¸¬è©¦å»ºç«‹æ´»å‹•åŠŸèƒ½</h1>
    
    <div class="container">
    <div class="form-group"></div>
        <label>ç®¡ç†å¯†ç¢¼:</label>
        <input type="password" id="adminSecret" placeholder="è¼¸å…¥ ADMIN_SECRET">
    </div>

    <div class="form-group">
        <label>æ´»å‹•åç¨±:</label>
        <input type="text" id="eventName" value="2025 æ¸¬è©¦äº¤æ›ç¦®ç‰©">
    </div>

    <div class="form-group">
        <label>ç¦®ç‰©é‡‘é¡:</label>
        <input type="text" id="giftAmount" value="$500 - $700">
    </div>

    <div class="form-group">
        <label>çµ„åˆ¥è¨­å®š (JSON):</label>
        <textarea id="groupsConfig" rows="10">[
  { "id": 1, "name": "å…‰ä½‘", "limit": 1, "members": ["å…‰ä½‘"] },
  { "id": 2, "name": "Jefferson", "limit": 1, "members": ["Jefferson"] },
  { "id": 3, "name": "PJä¸€å®¶", "limit": 2, "members": ["PJ", "PJå¤ªå¤ª"] }
]</textarea>
    </div>

    <div class="button-group">
        <button onclick="createEvent()">ğŸ å»ºç«‹æ´»å‹•</button>
        <button onclick="listEvents()">ğŸ“‹ åˆ—å‡ºæ‰€æœ‰æ´»å‹•</button>
    </div>

    <div id="result" class="result" style="display:none;"></div>
    </div>

    <script>
        async function createEvent() {
            const secret = document.getElementById('adminSecret').value;
            const eventName = document.getElementById('eventName').value;
            const giftAmount = document.getElementById('giftAmount').value;
            const groupsConfig = document.getElementById('groupsConfig').value;

            try {
                const groups = JSON.parse(groupsConfig);
                
                const response = await fetch('/api/create-event', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${secret}`
                    },
                    body: JSON.stringify({ eventName, giftAmount, groups })
                });

                const result = await response.json();
                const resultDiv = document.getElementById('result');
                resultDiv.style.display = 'block';
                
                if (response.ok) {
                    resultDiv.innerHTML = `<h3>âœ… æˆåŠŸï¼</h3>
                        <p><strong>æ´»å‹• ID:</strong> ${result.event.id}</p>
                        <p><strong>æ´»å‹•åç¨±:</strong> ${result.event.eventName}</p>
                        <p><strong>å‰å°é€£çµ:</strong> <a href="/?event=${result.event.id}" target="_blank">/?event=${result.event.id}</a></p>
                        <pre>${JSON.stringify(result.event, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML = `<h3>âŒ å¤±æ•—</h3><p>${result.message || result.error}</p>`;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `<h3>âŒ éŒ¯èª¤</h3><p>${error.message}</p>`;
                document.getElementById('result').style.display = 'block';
            }
        }

        async function listEvents() {
            const secret = document.getElementById('adminSecret').value;
            
            try {
                const response = await fetch('/api/status', {
                    headers: {
                        'Authorization': `Bearer ${secret}`
                    }
                });

                const events = await response.json();
                const resultDiv = document.getElementById('result');
                resultDiv.style.display = 'block';
                
                if (response.ok) {
                    resultDiv.innerHTML = `<h3>ğŸ“‹ æ‰€æœ‰æ´»å‹•åˆ—è¡¨</h3>
                        <pre>${JSON.stringify(events, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML = `<h3>âŒ å¤±æ•—</h3><p>${events.message || events.error}</p>`;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `<h3>âŒ éŒ¯èª¤</h3><p>${error.message}</p>`;
                document.getElementById('result').style.display = 'block';
            }
        }
    </script>
</body>
</html>
